#!/bin/bash
# Script to restore "–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç" backup

BACKUP_DIR="backup/–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π_–ø–æ–¥—Å—á–µ—Ç"

echo "üîÑ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –ø—Ä–æ–º–ø—Ç—ã –∏–∑ –±–µ–∫–∞–ø–∞ '–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç'..."

if [ ! -d "$BACKUP_DIR" ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: –ü–∞–ø–∫–∞ –±–µ–∫–∞–ø–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: $BACKUP_DIR"
    exit 1
fi

echo "üìÅ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é —Ñ–∞–π–ª—ã –∏–∑ $BACKUP_DIR..."

# Restore api_client.py
if [ -f "$BACKUP_DIR/api_client.py" ]; then
    cp "$BACKUP_DIR/api_client.py" api_client.py
    echo "‚úÖ api_client.py –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    echo "‚ùå api_client.py –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–µ–∫–∞–ø–µ"
fi

# Restore services/food_analysis_service.py
if [ -f "$BACKUP_DIR/food_analysis_service.py" ]; then
    cp "$BACKUP_DIR/food_analysis_service.py" services/food_analysis_service.py
    echo "‚úÖ services/food_analysis_service.py –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    echo "‚ùå food_analysis_service.py –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–µ–∫–∞–ø–µ"
fi

# Restore handlers/misc.py
if [ -f "$BACKUP_DIR/misc.py" ]; then
    cp "$BACKUP_DIR/misc.py" handlers/misc.py
    echo "‚úÖ handlers/misc.py –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    echo "‚ùå misc.py –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–µ–∫–∞–ø–µ"
fi

# Restore handlers/media.py
if [ -f "$BACKUP_DIR/media.py" ]; then
    cp "$BACKUP_DIR/media.py" handlers/media.py
    echo "‚úÖ handlers/media.py –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    echo "‚ùå media.py –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–µ–∫–∞–ø–µ"
fi

echo ""
echo "‚úÖ –ü—Ä–æ–º–ø—Ç—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ –±–µ–∫–∞–ø–∞: $BACKUP_DIR"
echo "üìÅ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:"
echo "   - api_client.py"
echo "   - services/food_analysis_service.py"
echo "   - handlers/misc.py"
echo "   - handlers/media.py"
echo ""
echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:"
echo "   pkill -f 'python main.py' && sleep 2 && python main.py"

