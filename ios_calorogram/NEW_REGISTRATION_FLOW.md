# Новый Flow Регистрации iOS

## Логика (как в Telegram боте)

### 1. Не авторизован → AuthView
- Показывается экран выбора способа регистрации
- Выбор: Email, Телефон, Apple ID
- После выбора → форма входа/регистрации

### 2. Авторизован + Новый пользователь → WelcomeScreen
- Приветственный экран с описанием возможностей
- Кнопка "Начать" → переход к Onboarding

### 3. Onboarding → Заполнение профиля
- Name (имя)
- Gender (пол)
- Age (возраст)
- Height (рост)
- Weight (вес)
- Activity Level (уровень активности)
- Goal (цель)

### 4. Профиль заполнен → MainTabView
- Основное приложение
- При повторном входе сразу показывается главный экран

## Флаги состояния

### `hasSeenWelcome` (AppStorage)
- `false` → показать WelcomeScreen
- `true` → пропустить WelcomeScreen

### `hasCompletedOnboarding` (AppStorage)
- `false` → показать OnboardingView
- `true` → пропустить OnboardingView

### `isUserRegistered` (computed)
- Проверяет, заполнен ли профиль (age, height, weight)
- `true` → профиль заполнен, показать MainTabView
- `false` → профиль не заполнен, показать Welcome/Onboarding

## Сценарии

### Новый пользователь (первый запуск)
1. Запуск → AuthView (выбор способа)
2. Регистрация → WelcomeScreen
3. "Начать" → OnboardingView
4. Заполнение профиля → MainTabView

### Существующий пользователь (повторный вход)
1. Запуск → AuthView
2. Вход → MainTabView (сразу, без Welcome/Onboarding)

### Пользователь вышел, но не завершил onboarding
1. Запуск → AuthView
2. Вход → OnboardingView (продолжение с того места, где остановились)
3. Завершение → MainTabView

## Отличия от предыдущей версии

### Было:
- Авторизация → сразу Onboarding (без приветствия)
- При повторном входе мог показываться Onboarding снова

### Стало:
- Авторизация → WelcomeScreen → Onboarding → MainTabView
- При повторном входе сразу MainTabView (если профиль заполнен)
- Флаги сбрасываются автоматически, если профиль заполнен

## Тестирование

### Сценарий 1: Новая регистрация
1. Удалите приложение (чтобы сбросить AppStorage)
2. Запустите → должен показаться AuthView
3. Выберите Email → Регистрация
4. Введите данные → должен показаться WelcomeScreen
5. Нажмите "Начать" → должен показаться OnboardingView
6. Заполните все поля → должен показаться MainTabView

### Сценарий 2: Повторный вход
1. Выйдите из приложения (logout)
2. Запустите → должен показаться AuthView
3. Выберите Email → Вход
4. Введите данные → должен сразу показаться MainTabView (без Welcome/Onboarding)

### Сценарий 3: Перезапуск без выхода
1. Закройте приложение
2. Запустите снова → должен сразу показаться MainTabView (токен сохранен)

