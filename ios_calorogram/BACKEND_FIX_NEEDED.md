# üîß –ü—Ä–æ–±–ª–µ–º–∞ —Å backend: —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

## –ü—Ä–æ–±–ª–µ–º–∞

Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É `{"detail":"Invalid init data"}` –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –¥–∞–∂–µ –∫–æ–≥–¥–∞ endpoint `/api/auth/register` –Ω–µ –¥–æ–ª–∂–µ–Ω —Ç—Ä–µ–±–æ–≤–∞—Ç—å Telegram init_data.

## –ß—Ç–æ —è —Å–¥–µ–ª–∞–ª

1. ‚úÖ –î–æ–±–∞–≤–∏–ª –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `app/api/auth.py` (endpoint `/register`)
2. ‚úÖ –î–æ–±–∞–≤–∏–ª –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `app/blocks/auth.py` (—Ñ—É–Ω–∫—Ü–∏—è `get_telegram_id`)
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏–ª, —á—Ç–æ endpoint `/register` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Depends(get_telegram_id)`

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend –Ω–∞ Railway

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ Railway dashboard
2. –û—Ç–∫—Ä–æ–π—Ç–µ –ª–æ–≥–∏ –≤–∞—à–µ–≥–æ backend —Å–µ—Ä–≤–∏—Å–∞
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å—Ç—Ä–æ–∫–∏:
   - `üîµ iOS Register endpoint called with email: ...` - –µ—Å–ª–∏ endpoint –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
   - `üî¥ get_telegram_id called with init_data: ...` - –µ—Å–ª–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è get_telegram_id

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç –ª–∏ endpoint

–í–æ–∑–º–æ–∂–Ω–æ, –µ—Å—Ç—å –¥—Ä—É–≥–æ–π endpoint `/register`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ù–µ—Ç –ª–∏ –¥—Ä—É–≥–æ–≥–æ —Ä–æ—É—Ç–µ—Ä–∞ —Å endpoint `/register`, –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ –∫ `/api/auth`
- –ù–µ—Ç –ª–∏ middleware, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç init_data –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –í–∞—Ä–∏–∞–Ω—Ç 3: –í—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å endpoint

–ú–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø—É—Ç—å endpoint –Ω–∞ `/register-ios` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```python
@router.post("/register-ios")
async def register_email_password(request: EmailRegisterRequest):
    ...
```

–ò –æ–±–Ω–æ–≤–∏—Ç—å iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```swift
static let register = "/auth/register-ios"
```

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ
- ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend –Ω–∞ Railway
- ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend –Ω–∞ Railway (–∏–ª–∏ –¥–æ–∂–¥–∏—Ç–µ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è)
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ –ª–æ–≥–∏, –∏ —è –ø–æ–º–æ–≥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è

